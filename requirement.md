# TableClip - 需求文档

## 📋 项目概述

**项目名称**: TableClip - 表格格式转换工具  
**项目描述**: 一个强大的在线表格格式转换工具，支持从 Excel 剪贴板读取表格数据并转换为多种格式输出  
**技术架构**: 纯前端 HTML5 + CSS3 + ES6+ JavaScript  

## ✨ 核心功能需求

### 1. 剪贴板数据解析
- **1.1** 支持从系统剪贴板读取表格数据
- **1.2** 智能解析 HTML 格式表格数据（优先级高）
- **1.3** 回退支持纯文本格式数据解析
- **1.4** 自动检测表格结构和列分隔符
- **1.5** 提取并保留单元格样式信息
- **1.6** 处理各种复杂的合并单元格情况

### 2. 表格结构处理
- **2.1** 智能检测表头行
- **2.2** 完整支持合并单元格（colspan、rowspan）
- **2.3** 处理不规则表格结构
- **2.4** 保持原始表格的逻辑关系
- **2.5** 支持空单元格和空行处理

### 3. 多格式导出支持

#### 3.1 HTML 格式
- **3.1.1** 生成标准 HTML 表格结构
- **3.1.2** 支持完整的合并单元格属性（colspan、rowspan）
- **3.1.3** 可选包含内联样式
- **3.1.4** 支持响应式表格代码生成
- **3.1.5** **[新增]** 可选样式配置：
  - 标题行加粗样式
  - 标题列加粗样式
  - 阴阳行背景色（白色/浅灰色交替）
  - 默认样式预设选项

#### 3.2 Markdown 格式
- **3.2.1** 标准 Markdown 表格语法
- **3.2.2** 自动生成表头分隔符
- **3.2.3** 合并单元格内容显示在左上角第一个位置
- **3.2.4** 其他合并位置留空处理
- **3.2.5** **[新增]** 智能列宽调整：
  - 根据每列实际内容长度计算合适的分隔符宽度
  - 分隔符 '-' 个数与列内容宽度匹配
  - 确保表格美观和可读性

#### 3.3 Textile 格式
- **3.3.1** 完整的 Textile 表格标记
- **3.3.2** 支持表头标记（_. 语法）
- **3.3.3** 支持合并单元格语法（\n.、/n. 语法）
- **3.3.4** 支持文本对齐标记

#### 3.4 reStructuredText (RST) 格式
- **3.4.1** 标准 RST 表格格式
- **3.4.2** 自动计算列宽并生成边框
- **3.4.3** 完整的表格边框结构
- **3.4.4** 合并单元格信息标记
- **3.4.5** 内容长度溢出处理

### 4. 用户界面需求

#### 4.1 主界面布局
- **4.1.1** 响应式设计，支持桌面端和移动端
- **4.1.2** 现代化卡片式布局
- **4.1.3** 清晰的功能区域划分
- **4.1.4** 优雅的渐变背景和动画效果

#### 4.2 操作面板
- **4.2.1** 粘贴按钮和快捷键支持
- **4.2.2** 格式选择按钮组
- **4.2.3** 导出选项配置面板
- **4.2.4** **[新增]** HTML 样式选项配置

#### 4.3 预览和输出区域
- **4.3.1** 实时表格预览
- **4.3.2** 代码输出显示
- **4.3.3** 复制到剪贴板功能
- **4.3.4** 文件下载功能

### 5. 配置选项需求

#### 5.1 通用选项
- **5.1.1** 保持合并单元格开关
- **5.1.2** 包含样式信息开关
- **5.1.3** 响应式表格开关

#### 5.2 HTML 专用选项 **[新增]**
- **5.2.1** 标题行加粗样式开关
- **5.2.2** 标题列加粗样式开关
- **5.2.3** 阴阳行背景色开关
- **5.2.4** 默认样式预设选择器

### 6. 技术需求

#### 6.1 兼容性需求
- **6.1.1** 现代浏览器支持（Chrome 66+、Firefox 63+、Safari 13.1+、Edge 79+）
- **6.1.2** 剪贴板 API 支持（HTTPS 环境或 localhost）
- **6.1.3** 跨平台兼容性

#### 6.2 性能需求
- **6.2.1** 大表格处理能力（建议支持 100x100 以内）
- **6.2.2** 实时预览性能优化
- **6.2.3** 内存使用控制

#### 6.3 安全需求
- **6.3.1** 纯前端处理，数据不上传
- **6.3.2** 本地数据存储安全
- **6.3.3** XSS 防护和数据转义

## 🧪 测试需求 **[新增]**

### 7. 测试用例需求

#### 7.1 基础功能测试
- **7.1.1** 简单表格解析和转换
- **7.1.2** 各种格式导出验证
- **7.1.3** 剪贴板权限和兼容性测试

#### 7.2 合并单元格测试 **[重点新增]**
- **7.2.1** 单行合并测试（任意位置）
  - 表头行合并
  - 数据行开头合并
  - 数据行中间合并
  - 数据行末尾合并
- **7.2.2** 单列合并测试（任意位置）
  - 第一列合并
  - 中间列合并
  - 最后列合并
  - 跨多行合并
- **7.2.3** 复杂区域合并测试
  - 局部矩形区域合并
  - 不规则形状合并
  - 多个分离合并区域
  - 嵌套合并结构

#### 7.3 边界情况测试
- **7.3.1** 空表格处理
- **7.3.2** 单行单列表格
- **7.3.3** 全合并表格
- **7.3.4** 特殊字符和 Unicode 内容

#### 7.4 新功能测试
- **7.4.1** Markdown 自适应列宽测试
- **7.4.2** HTML 样式选项测试
- **7.4.3** 各种预设样式效果验证

## 📁 项目结构需求

### 8. 文件组织结构
```
TableClip/
├── index.html              # 主应用页面
├── example.html            # 功能示例展示
├── test.html              # 基础测试页面
├── requirement.md         # 需求文档（本文件）
├── README.md              # 项目说明文档
├── start.md              # 快速启动指南
├── css/
│   └── style.css         # 主样式文件
├── js/
│   ├── tableParser.js    # 表格解析模块
│   ├── formatExporters.js # 格式导出模块
│   └── app.js           # 主应用逻辑
└── tests/               # **[新增]** 测试目录
    ├── index.html       # 测试导航页面
    ├── basic-test.html  # 基础功能测试
    ├── merge-row.html   # 行合并测试
    ├── merge-col.html   # 列合并测试
    ├── merge-area.html  # 区域合并测试
    └── edge-cases.html  # 边界情况测试
```

## 🎯 用户故事

### 9. 核心用户场景

#### 9.1 文档编写者
- **场景**: 需要将 Excel 表格快速转换为 Markdown 格式
- **需求**: 保持表格结构，自动调整列宽，处理合并单元格
- **期望**: 生成美观的 Markdown 表格，可直接粘贴到文档中

#### 9.2 网页开发者
- **场景**: 需要将设计稿中的表格转换为 HTML 代码
- **需求**: 生成标准 HTML 表格，包含样式选项，支持响应式
- **期望**: 获得可直接使用的 HTML 代码，减少手工编写时间

#### 9.3 技术写作者
- **场景**: 需要在技术文档中插入格式化表格
- **需求**: 支持 RST 格式，保持专业排版效果
- **期望**: 生成符合文档标准的表格代码

## 🔄 版本规划

### 10. 开发里程碑

#### v1.0.0 - 基础版本 ✅
- 核心表格解析功能
- 四种格式基础导出
- 基本用户界面

#### v1.0.1 - 问题修复 ✅
- Markdown 合并单元格问题修复
- RST 格式错误修复

#### v1.1.0 - 功能增强 **[当前版本]**
- Markdown 智能列宽调整
- HTML 样式选项扩展
- 完整测试套件

#### v1.2.0 - 未来规划
- 更多导出格式支持
- 高级样式定制
- 批量处理功能

## 📊 验收标准

### 11. 功能验收标准

#### 11.1 Markdown 列宽功能
- [ ] 分隔符长度根据列内容自动调整
- [ ] 中文字符宽度正确计算
- [ ] 最小宽度保证（至少3个字符）
- [ ] 合并单元格标记长度考虑在内

#### 11.2 HTML 样式功能
- [ ] 标题行加粗样式正确应用
- [ ] 标题列加粗样式正确应用
- [ ] 阴阳行背景色交替显示
- [ ] 样式选项独立可控
- [ ] 预设样式一键应用

#### 11.3 测试覆盖标准
- [ ] 所有合并单元格类型测试覆盖
- [ ] 边界情况处理验证
- [ ] 新功能完整测试
- [ ] 回归测试通过

---

**文档版本**: v1.1.0  
**最后更新**: 2024-01-01  
**维护者**: TableClip 开发团队 