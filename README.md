# TableClip - 表格格式转换工具

一个强大的在线表格格式转换工具，支持从 Excel 剪贴板读取表格数据并转换为多种格式输出。

## ✨ 功能特性

- 🔄 **剪贴板集成**: 直接从 Excel 复制表格区域并粘贴
- 📊 **多格式导出**: 支持 HTML、Markdown、Textile、reStructuredText 格式
- 🔗 **合并单元格**: 保持原始表格的合并单元格结构
- 🎨 **样式保留**: 可选择保留表格的样式信息
- 📱 **响应式设计**: 支持生成响应式表格代码
- ⚡ **实时预览**: 即时查看表格效果
- 💾 **一键导出**: 支持复制到剪贴板或下载文件
- 🎯 **纯前端**: 无需服务器，数据不上传

## 🚀 在线使用

直接打开 `index.html` 文件即可在浏览器中使用，无需任何安装或配置。

### 使用步骤

1. **复制表格**: 在 Excel 中选择表格区域并复制 (Ctrl+C)
2. **粘贴数据**: 点击 "粘贴表格数据" 按钮或使用快捷键 Ctrl+V
3. **选择格式**: 选择要导出的目标格式 (HTML/Markdown/Textile/RST)
4. **调整选项**: 根据需要调整导出选项
5. **获取结果**: 复制代码或下载文件

## 📋 支持的格式

### HTML
- 完整的 HTML 表格结构
- 支持合并单元格 (`colspan`、`rowspan`)
- 可包含内联样式
- 可生成响应式表格代码

### Markdown
- 标准 Markdown 表格语法
- 自动检测表头行
- 支持合并单元格信息注释

### Textile
- Textile 标记语言表格
- 支持表头标记 (`_.`)
- 支持合并单元格语法 (`\n.`, `/n.`)
- 支持文本对齐标记

### reStructuredText (RST)
- 标准 RST 表格格式
- 自动计算列宽
- 完整的边框结构
- 支持合并单元格信息

## ⚙️ 配置选项

### 保持合并单元格
- **开启**: 在目标格式中保留合并单元格信息
- **关闭**: 将合并单元格拆分为单独单元格

### 包含样式信息
- **开启**: 在 HTML 输出中包含内联样式
- **关闭**: 仅输出结构化的 HTML

### 响应式表格
- **开启**: 生成移动端友好的响应式表格代码
- **关闭**: 生成标准表格代码

## 🔧 技术实现

### 架构设计
```
TableClip/
├── index.html          # 主界面
├── css/
│   └── style.css      # 样式文件
├── js/
│   ├── tableParser.js # 表格解析模块
│   ├── formatExporters.js # 格式导出模块
│   └── app.js         # 主应用逻辑
└── README.md          # 项目文档
```

### 核心模块

#### TableParser
负责解析剪贴板中的表格数据：
- 支持 HTML 格式和纯文本格式
- 智能检测表格结构
- 处理合并单元格
- 提取样式信息

#### FormatExporters
负责将解析后的数据转换为不同格式：
- HTML 导出器：完整的 HTML 表格
- Markdown 导出器：标准 Markdown 语法
- Textile 导出器：Textile 标记语言
- RST 导出器：reStructuredText 格式

#### TableClipApp
主应用控制器：
- 协调各模块工作
- 处理用户交互
- 管理界面状态
- 提供导出功能

### 浏览器兼容性

- ✅ Chrome 66+
- ✅ Firefox 63+
- ✅ Safari 13.1+
- ✅ Edge 79+

**注意**: 剪贴板 API 需要 HTTPS 环境或 localhost

## 🔒 隐私安全

- **本地处理**: 所有数据处理在浏览器本地进行
- **无网络传输**: 不向任何服务器发送数据
- **临时存储**: 数据仅在页面会话中保存
- **安全访问**: 需要用户明确授权访问剪贴板

## 🎨 自定义样式

可以通过修改 `css/style.css` 来自定义界面样式：

```css
/* 自定义主题色 */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
}

/* 自定义表格样式 */
.table-container table {
    /* 你的自定义样式 */
}
```

## 📝 使用示例

### Excel 复制到 Markdown

1. 在 Excel 中选择表格：
```
姓名    年龄    城市
张三    25     北京
李四    30     上海
```

2. 复制并粘贴到 TableClip

3. 选择 Markdown 格式，得到输出：
```markdown
| 姓名 | 年龄 | 城市 |
| --- | --- | --- |
| 张三 | 25 | 北京 |
| 李四 | 30 | 上海 |
```

### 合并单元格处理

Excel 中的合并单元格：
```
部门        员工信息
销售部      张三
           李四
```

转换为 HTML：
```html
<table>
  <tr>
    <th>部门</th>
    <th>员工信息</th>
  </tr>
  <tr>
    <td rowspan="2">销售部</td>
    <td>张三</td>
  </tr>
  <tr>
    <td>李四</td>
  </tr>
</table>
```

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 开发环境
```bash
# 克隆项目
git clone [repository-url]

# 进入项目目录
cd TableClip

# 使用本地服务器运行 (推荐)
python -m http.server 8000
# 或使用 Node.js
npx serve .

# 在浏览器中访问
# http://localhost:8000
```

### 代码规范
- 使用 ES6+ 语法
- 遵循语义化命名
- 添加必要的注释
- 保持代码格式一致

## 📄 许可证

MIT License

## 🔄 更新日志

### v1.0.1 (2024-01-01)
- 🐛 修复 Markdown 格式合并单元格处理逻辑
- 🐛 修复 RST 格式的索引越界错误
- ✅ Markdown 格式现在将合并内容显示在左上角第一个位置，其他位置留空
- ✅ RST 格式现在可以正确处理合并单元格而不报错
- 📝 添加测试页面验证修复效果

### v1.0.0 (2024-01-01)
- 🎉 初始版本发布
- ✅ 支持基本的表格解析和格式转换
- ✅ 完整的用户界面
- ✅ 四种导出格式支持

## 🆘 常见问题

### Q: 为什么粘贴按钮没有反应？
A: 请确保：
1. 浏览器支持剪贴板 API
2. 页面在 HTTPS 环境或 localhost 下运行
3. 已授权剪贴板访问权限

### Q: 合并单元格为什么显示不正确？
A: 不同格式对合并单元格的支持程度不同：
- HTML: 完全支持
- Markdown: 有限支持，会添加注释
- Textile: 支持基本合并
- RST: 会添加合并信息注释

### Q: 如何处理复杂的表格样式？
A: 目前支持基本样式提取，复杂样式可能需要手动调整输出结果。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至 [your-email]

---

**TableClip** - 让表格格式转换变得简单高效！ 🚀 